#ifndef _WIND_CONTAINERS_H_
#define _WIND_CONTAINERS_H_

#include <cstdlib>

namespace wind 
{ 

template <class T> class Array
{
private:

	class ValueHandler
	{
	private:
		T * array;
		int index;
	public:
		ValueHandler ()
		{
			array = 0;
			index = 0;
		}

		void Set (T * array_, int index_)
		{
			array = array_;
			index = index_;
		}

		void operator= (int val)
		{
			array[index] = val;
		}

		T value ()
		{
			return array[index];
		}
	};

	void Extend (int index)
	{
		int size_ = (index > size ? index : size) * EXPANSION_RATIO;
		T * A_ = (T*) malloc (sizeof(T) * size_);
		for (int i = 0; i < size; i++)
		{
			A_[i] = A[i];
		}
		delete A;
		A = A_;
		size = size_;
	}

	ValueHandler handler;
	T * A;
	int size;
	float EXPANSION_RATIO;
	static const int DEFAULT_SIZE = 10;

public:
	Array ()
	{
			size = DEFAULT_SIZE;
			A = (T*) malloc (sizeof(T) * size);
			EXPANSION_RATIO = 1.5f;
	}

	Array (int size_)
	{
			size = size_;
			A = (T*) malloc (sizeof(T) * size);
			EXPANSION_RATIO = 1.5f;
	}

	~Array ()
	{
		delete A;
	}

	ValueHandler operator[] (int index)
	{
		if (index > (size-1)) Extend (index);
		handler.Set(A, index);
		return handler;
	}
};

}
#endif
